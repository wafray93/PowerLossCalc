{% extends "base.html" %}

{% block title %}–ê–Ω–∞–ª–∏–∑{% endblock %}

{% block canonical %}
<link rel="canonical" href="https://powerlosscalc.onrender.com/analysis">
{% endblock %}

{% block page_title %}
<span data-lang="analysisPageTitle">–ì—Ä–∞—Ñ–∏–∫–∏ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç –∏ –∑–∞–≥—É–±–∏</span>
{% endblock %}

{% block page_description %}
<span data-lang="analysisPageDescription">
–ê–Ω–∞–ª–∏–∑–∏—Ä–∞–π—Ç–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä–∏ —á—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏ –≥—Ä–∞—Ñ–∏–∫–∏.
</span>
{% endblock %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<section class="analysis-content">
  <!-- Selected Transistor Info Section -->
  <div class="analysis-section transistor-info-section">
    <h2 data-lang="transistorInfo">üì¶ –ò–∑–ø–æ–ª–∑–≤–∞–Ω —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä –∑–∞ –∞–Ω–∞–ª–∏–∑</h2>
    <div id="analysisTransistorInfo" class="analysis-transistor-info">
      <div class="transistor-alert" id="analysisTransistorAlert">
        <div class="alert-content">
          <span data-lang="noTransistorSelected">
            ‚ö†Ô∏è –ù—è–º–∞ –∏–∑–±—Ä–∞–Ω —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä –æ—Ç Calculator. –ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ fallback –º–æ–¥–µ–ª –∑–∞ –∞–Ω–∞–ª–∏–∑.
          </span>
          <button id="goToCalculator" class="btn-link" data-lang="goToCalculator">
            –û—Ç–∏–¥–∏ –¥–æ Calculator
          </button>
        </div>
      </div>

      <div id="analysisTransistorData" class="transistor-data" style="display:none;">
        <div class="transistor-info-row"><span data-lang="model">–ú–æ–¥–µ–ª:</span> <span id="analysisModelName" class="transistor-value">-</span></div>
        <div class="transistor-info-row"><span data-lang="manufacturer">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª:</span> <span id="analysisManufacturer" class="transistor-value">-</span></div>
        <div class="transistor-info-row"><span data-lang="package">–ö–æ—Ä–ø—É—Å:</span> <span id="analysisPackage" class="transistor-value">-</span></div>
        <div class="transistor-info-row"><span>VDS max:</span> <span id="analysisVdsMax" class="transistor-value">-</span></div>
        <div class="transistor-info-row"><span>ID max:</span> <span id="analysisIdMax" class="transistor-value">-</span></div>
        <div class="transistor-info-row"><span>RDS(on):</span> <span id="analysisRdsOn" class="transistor-value">-</span></div>
      </div>
    </div>
  </div>

  <!-- Efficiency vs Frequency Analysis Section -->
  <div class="analysis-section">
    <h2 data-lang="efficiencyAnalysis">üìà –ê–Ω–∞–ª–∏–∑ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç —Å—Ä–µ—â—É —á–µ—Å—Ç–æ—Ç–∞</h2>
    <p data-lang="efficiencyDescription">
      –¢–∞–∑–∏ –≥—Ä–∞—Ñ–∏–∫–∞ –ø–æ–∫–∞–∑–≤–∞ –∫–∞–∫ —Å–µ –ø—Ä–æ–º–µ–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—Ç–∞ –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω–∏ —á–µ—Å—Ç–æ—Ç–∏ –∑–∞ Si, SiC –∏ GaN —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏—Ç–µ.
    </p>
    <div class="analysis-controls">
      <div class="control-group">
        <label for="freqMin" data-lang="frequencyRange">–ß–µ—Å—Ç–æ—Ç–µ–Ω –æ–±—Ö–≤–∞—Ç:</label>
        <input type="number" id="freqMin" value="1" min="0.1" max="10000" step="0.1">
        <span>-</span>
        <input type="number" id="freqMax" value="1000" min="0.1" max="10000" step="0.1">
        <span>kHz</span>
      </div>
      <button id="generateEffChart" data-lang="generateChart">–ì–µ–Ω–µ—Ä–∏—Ä–∞–π –≥—Ä–∞—Ñ–∏–∫–∞</button>
    </div>

    <div class="chart-container">
      <canvas id="efficiencyChart" width="800" height="400" style="display:none;"></canvas>
      <button id="copyEfficiencyChart" data-lang="copyChart" style="display:none;">üìã –ö–æ–ø–∏—Ä–∞–π –≥—Ä–∞—Ñ–∏–∫–∞</button>
    </div>

    <div id="efficiencyInsights" class="scientific-insights" style="display:none;"></div>
  </div>

  <!-- Thermal Analysis Section -->
  <div class="analysis-section">
    <h2 data-lang="thermalModeling">üå°Ô∏è –¢–µ—Ä–º–∏—á–Ω–æ –º–æ–¥–µ–ª–∏—Ä–∞–Ω–µ</h2>
    <p data-lang="thermalDescription">
      –ê–Ω–∞–ª–∏–∑–∏—Ä–∞ –∫–∞–∫ —Å–µ –∑–∞–≥—Ä—è–≤–∞ —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä—ä—Ç –∏ –¥–∞–ª–∏ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ö–ª–∞–∂–¥–∞–Ω–µ.
      –ò–∑—á–∏—Å–ª—è–≤–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏—Ç–µ –Ω–∞ –ø–æ–ª—É–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–æ–≤–∏—è —á–∏–ø (junction) –∏ –∫–æ—Ä–ø—É—Å–∞ –≤—ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ –º–æ—â–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –∑–∞–≥—É–±–∏—Ç–µ.
    </p>

    <div class="thermal-controls">
      <div class="control-group">
        <label for="ambientTemp" data-lang="ambientTemp">–û–∫–æ–ª–Ω–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C):</label>
        <input type="number" id="ambientTemp" value="25" min="-40" max="85" step="1">
      </div>

      <div class="control-group">
        <label for="coolingType" data-lang="coolingType">–¢–∏–ø –æ—Ö–ª–∞–∂–¥–∞–Ω–µ:</label>
        <select id="coolingType">
          <option value="natural" data-lang="naturalCooling">–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–æ (—Å–∞–º–æ –∫–æ—Ä–ø—É—Å, 50¬∞C/W)</option>
          <option value="small_heatsink" data-lang="smallHeatsink">–ú–∞–ª—ä–∫ —Ä–∞–¥–∏–∞—Ç–æ—Ä (15¬∞C/W)</option>
          <option value="medium_heatsink" data-lang="mediumHeatsink" selected>–°—Ä–µ–¥–µ–Ω —Ä–∞–¥–∏–∞—Ç–æ—Ä (6¬∞C/W)</option>
          <option value="large_heatsink" data-lang="largeHeatsink">–ì–æ–ª—è–º —Ä–∞–¥–∏–∞—Ç–æ—Ä (2.5¬∞C/W)</option>
          <option value="forced_air" data-lang="forcedAir">–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª–Ω–æ –≤—ä–∑–¥—É—à–Ω–æ (1.5¬∞C/W)</option>
          <option value="liquid_cooling" data-lang="liquidCooling">–¢–µ—á–Ω–æ –æ—Ö–ª–∞–∂–¥–∞–Ω–µ (0.3¬∞C/W)</option>
        </select>
      </div>

      <button id="calculateThermal" data-lang="calculateThermal">–ò–∑—á–∏—Å–ª–∏ —Ç–µ—Ä–º–∏—á–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏</button>
    </div>

    <div id="thermalResults" class="thermal-results" style="display:none;">
      <h3 data-lang="thermalResults">–¢–µ—Ä–º–∏—á–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏</h3>
      <div id="thermalStatus" class="thermal-status"></div>
      <div class="thermal-data">
        <div class="thermal-item"><span data-lang="junctionTemp">Tj:</span> <span id="junctionTemp" class="thermal-value">-</span></div>
        <div class="thermal-item"><span data-lang="caseTemp">Tc:</span> <span id="caseTemp" class="thermal-value">-</span></div>
        <div class="thermal-item"><span data-lang="thermalResistance">Rth:</span> <span id="thermalResistance" class="thermal-value">-</span></div>
        <div class="thermal-item"><span data-lang="thermalMargin">–ú–∞—Ä–∂:</span> <span id="thermalMargin" class="thermal-value">-</span></div>
      </div>
      <div id="thermalExplanation" class="thermal-explanation"></div>
    </div>
  </div>

  <!-- Technology Comparison Section -->
  <div class="analysis-section">
    <h2 data-lang="techComparison">‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏—Ç–µ</h2>
    <div class="theory-comparison">
      <div class="tech-card si">
        <h4>üü§ Si</h4>
        <div class="tech-value">Bandgap: 1.12 eV</div>
        <div class="tech-value">fmax: 10-100 kHz</div>
        <div class="tech-value">Tmax: 150¬∞C</div>
      </div>
      <div class="tech-card sic">
        <h4>üü† SiC</h4>
        <div class="tech-value">Bandgap: 3.3 eV</div>
        <div class="tech-value">fmax: 50-500 kHz</div>
        <div class="tech-value">Tmax: 200¬∞C</div>
      </div>
      <div class="tech-card gan">
        <h4>üü¢ GaN</h4>
        <div class="tech-value">Bandgap: 3.4 eV</div>
        <div class="tech-value">fmax: 100kHz-2MHz</div>
        <div class="tech-value">Tmax: 200¬∞C</div>
      </div>
    </div>
  </div>

  <!-- Advanced Analysis Section -->
  <div class="analysis-section">
    <h2>üßÆ –ù–∞–ø—Ä–µ–¥–Ω–∞–ª –∞–Ω–∞–ª–∏–∑</h2>
    <div class="advanced-analysis">
      <h3>–ù–∞—É—á–Ω–∏ –º–æ–¥–µ–ª–∏ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏</h3>
      <div class="physics-constants">
        <h4>Si (–°–∏–ª–∏—Ü–∏–π)</h4>
        <div class="constant-item"><span class="clickable-term" data-term="coss">Coss:</span><span>800 pF</span></div>
        <div class="constant-item"><span class="clickable-term" data-term="cgd">Cgd:</span><span>120 pF</span></div>
        <div class="constant-item"><span class="clickable-term" data-term="temp_coeff">Temp Coeff:</span><span>0.6%/¬∞C</span></div>
      </div>

      <div class="physics-constants">
        <h4>SiC (–°–∏–ª–∏—Ü–∏–µ–≤ –∫–∞—Ä–±–∏–¥)</h4>
        <div class="constant-item"><span class="clickable-term" data-term="coss">Coss:</span><span>180 pF</span></div>
        <div class="constant-item"><span class="clickable-term" data-term="cgd">Cgd:</span><span>45 pF</span></div>
      </div>

      <div class="physics-constants">
        <h4>GaN (–ì–∞–ª–∏–µ–≤ –Ω–∏—Ç—Ä–∏–¥)</h4>
        <div class="constant-item"><span class="clickable-term" data-term="coss">Coss:</span><span>65 pF</span></div>
        <div class="constant-item"><span class="clickable-term" data-term="cgd">Cgd:</span><span>15 pF</span></div>
      </div>
    </div>
  </div>
</section>

<!-- Overlay Modal -->
<div id="overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000;"></div>
<div id="termExplanation" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 10px; z-index: 1001; max-width: 600px; max-height: 80vh; overflow-y: auto;">
  <button onclick="closeTermExplanation()" style="float: right; border: none; background: none; font-size: 18px; cursor: pointer;">&times;</button>
  <h3 id="termTitle"></h3>
  <div id="termContent"></div>
</div>

<style>
/* CSS –æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ —Ç–∏ –æ—Å—Ç–∞–≤–∞ –±–µ–∑ –ø—Ä–æ–º—è–Ω–∞ */
.analysis-section { margin-bottom: 40px; padding: 20px; border: 1px solid var(--border-color); border-radius: 10px; background: var(--card-bg); }
/* –∏ —Ç.–Ω. ‚Äî –æ—Å—Ç–∞–Ω–∞–ª–∏—è—Ç CSS –µ –∑–∞–ø–∞–∑–µ–Ω –∫–∞–∫—Ç–æ –≥–æ –ø—Ä–∞—Ç–∏ –ø—Ä–µ–¥–∏ */
</style>

{% endblock %}
