{% extends "base.html" %}

{% block title %}–î—Ä–∞–π–≤–µ—Ä–∏{% endblock %}

{% block page_title %}<span data-lang="driversPageTitle">–î—Ä–∞–π–≤–µ—Ä–∏ –∑–∞ Si/SiC/GaN —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä–∏</span>{% endblock %}

{% block page_description %}<span data-lang="driversPageDescription">–ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–æ –ø—Ä–µ–ø–æ—Ä—ä—á–≤–∞–Ω–µ –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä–∏ —Å–ø–æ—Ä–µ–¥ –∏–∑–±—Ä–∞–Ω —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä –∏ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ –∫–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∏ –∑–∞–≥—É–±–∏.</span>{% endblock %}

{% block extra_head %}
<!-- Chart.js –∑–∞ –≥—Ä–∞—Ñ–∏–∫–∏ -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<section class="controls">
  <h2 data-lang="driverSelection">–ò–∑–±–æ—Ä –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä</h2>
  
  <!-- Selected Transistor Info -->
  <div id="selectedTransistorCard" class="selected-transistor-card">
    <div class="card-header">
      <h3>üîß –ò–∑–±—Ä–∞–Ω —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä</h3>
      <button id="goToCalculatorBtn" class="secondary-btn" onclick="window.location.href='{{ url_for('calculator') }}'">
        <span data-lang="selectTransistor">–ò–∑–±–µ—Ä–∏ —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä</span>
      </button>
    </div>
    <div class="card-body" id="transistorCardBody">
      <p class="no-transistor-msg" data-lang="noTransistorSelected">–ù—è–º–∞ –∏–∑–±—Ä–∞–Ω —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä. –ò–∑–±–µ—Ä–µ—Ç–µ –æ—Ç –∫–∞–ª–∫—É–ª–∞—Ç–æ—Ä–∞ –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–µ–ø–æ—Ä—ä—á–≤–∞–Ω–µ –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä–∏.</p>
    </div>
  </div>
  
  <div class="row">
    <label class="input-group">
      <span data-lang="technology">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è</span>
      <span class="tooltip-icon">?</span>
      <div class="tooltip">–ò–∑–±–µ—Ä–µ—Ç–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä–∞: Si (—Å–∏–ª–∏—Ü–∏–µ–≤–∏ —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä–∏), SiC (—Å–∏–ª–∏—Ü–∏–µ–≤ –∫–∞—Ä–±–∏–¥), GaN (–≥–∞–ª–∏–µ–≤ –Ω–∏—Ç—Ä–∏–¥). –í—Å—è–∫–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –∏–º–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è –∫—ä–º –¥—Ä–∞–π–≤–µ—Ä–∞.</div>
      <select id="driverTechSelect" onchange="filterDrivers()">
        <option value="all">–í—Å–∏—á–∫–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
        <option value="Si">Si –¥—Ä–∞–π–≤–µ—Ä–∏</option>
        <option value="SiC" selected>SiC –¥—Ä–∞–π–≤–µ—Ä–∏</option>
        <option value="GaN">GaN –¥—Ä–∞–π–≤–µ—Ä–∏</option>
      </select>
    </label>

    <label class="input-group">
      <span data-lang="driverModel">–ú–æ–¥–µ–ª –¥—Ä–∞–π–≤–µ—Ä</span>
      <span class="tooltip-icon">?</span>
      <div class="tooltip">
        <strong>üìä –ò–∑—Ç–æ—á–Ω–∏–∫ –Ω–∞ –¥–∞–Ω–Ω–∏:</strong><br>
        –í—Å–∏—á–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å–∞ –æ—Ç –æ—Ñ–∏—Ü–∏–∞–ª–Ω–∏ datasheets –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏—Ç–µ. –ë–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏ —Å—ä–¥—ä—Ä–∂–∞ –¥—Ä–∞–π–≤–µ—Ä–∏ –æ—Ç Texas Instruments, Infineon –∏ ON Semiconductor.<br><br>
        <strong>üîß –ö–∞–∫ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º:</strong><br>
        ‚Ä¢ –í—ä–≤–µ–¥–µ—Ç–µ –º–æ–¥–µ–ª (–Ω–∞–ø—Ä. "UCC27531")<br>
        ‚Ä¢ –ò–ª–∏ –∏–∑–±–µ—Ä–µ—Ç–µ –æ—Ç —Å–ø–∏—Å—ä–∫–∞<br>
        ‚Ä¢ –ó–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–µ–ø–æ—Ä—ä—á–≤–∞–Ω–µ, –∏–∑–±–µ—Ä–µ—Ç–µ —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä –æ—Ç –∫–∞–ª–∫—É–ª–∞—Ç–æ—Ä–∞
      </div>
      <div class="transistor-selection-container">
        <input id="driverSelect" type="text" list="driverList" placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –∏–ª–∏ –∏–∑–±–µ—Ä–µ—Ç–µ –¥—Ä–∞–π–≤–µ—Ä..." autocomplete="off" onchange="updateDriverInfo()">
        <button type="button" id="clearDriver" class="clear-transistor-btn" title="–ò–∑—á–∏—Å—Ç–∏ –∏–∑–±–æ—Ä–∞" onclick="clearDriverSelection()">‚úï</button>
        <datalist id="driverList">
          <!-- –û–ø—Ü–∏–∏—Ç–µ —â–µ —Å–µ –ø–æ–ø—ä–ª–Ω—è—Ç –¥–∏–Ω–∞–º–∏—á–Ω–æ -->
        </datalist>
      </div>
    </label>
  </div>
  
  <!-- Recommend Driver Button -->
  <div class="button-row">
    <button id="recommendBtn" onclick="recommendDriver()" class="primary-btn" disabled>
      <span data-lang="recommendDriver">ü§ñ –ü—Ä–µ–ø–æ—Ä—ä—á–∞–π –¥—Ä–∞–π–≤–µ—Ä</span>
    </button>
    <button id="calculateDriverBtn" onclick="calculateDriverLosses()" class="secondary-btn">
      <span data-lang="calculateDriver">–ò–∑—á–∏—Å–ª–∏ –∑–∞–≥—É–±–∏ –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä–∞</span>
    </button>
  </div>
</section>

<!-- Recommended Drivers Section -->
<section id="recommendedSection" class="results" style="display: none;">
  <h2>üéØ –ü—Ä–µ–ø–æ—Ä—ä—á–∞–Ω–∏ –¥—Ä–∞–π–≤–µ—Ä–∏</h2>
  <div id="recommendedDrivers" class="recommended-drivers-grid">
    <!-- –©–µ —Å–µ –ø–æ–ø—ä–ª–Ω–∏ –¥–∏–Ω–∞–º–∏—á–Ω–æ -->
  </div>
</section>

<!-- Driver Information Section -->
<section class="results">
  <div class="results-header">
    <h2 data-lang="driverInfo">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –¥—Ä–∞–π–≤–µ—Ä–∞</h2>
    <button id="exportDriversCSV" class="btn-export" onclick="exportDriversToCSV()">üìä –°–≤–∞–ª–∏ –¥—Ä–∞–π–≤–µ—Ä–∏ CSV</button>
  </div>
  <div id="driverInfo" class="transistor-info" style="display: none;">
    <table>
      <tr><td><strong>–ú–æ–¥–µ–ª</strong></td><td id="driverModelName">‚Äî</td></tr>
      <tr><td><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª</strong></td><td id="driverManufacturer">‚Äî</td></tr>
      <tr><td><strong>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è</strong></td><td id="driverTechnology">‚Äî</td></tr>
      <tr><td><strong>V<sub>DD</sub> –¥–∏–∞–ø–∞–∑–æ–Ω</strong></td><td id="driverVddRange">‚Äî</td></tr>
      <tr><td><strong>I<sub>source</sub> max</strong></td><td id="driverISource">‚Äî</td></tr>
      <tr><td><strong>I<sub>sink</sub> max</strong></td><td id="driverISink">‚Äî</td></tr>
      <tr><td><strong>t<sub>rise</sub></strong></td><td id="driverTRise">‚Äî</td></tr>
      <tr><td><strong>t<sub>fall</sub></strong></td><td id="driverTFall">‚Äî</td></tr>
      <tr><td><strong>t<sub>delay</sub></strong></td><td id="driverTDelay">‚Äî</td></tr>
      <tr><td><strong>I<sub>q</sub> (quiescent)</strong></td><td id="driverIq">‚Äî</td></tr>
      <tr><td><strong>–ö–∞–Ω–∞–ª–∏</strong></td><td id="driverChannels">‚Äî</td></tr>
      <tr><td><strong>–ö–æ—Ä–ø—É—Å</strong></td><td id="driverPackage">‚Äî</td></tr>
      <tr><td><strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</strong></td><td id="driverFeatures">‚Äî</td></tr>
      <tr><td><strong>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</strong></td><td id="driverApplication">‚Äî</td></tr>
    </table>
  </div>

  <div class="educational-info">
    <h3>üí° –ö–∞–∫ –¥–∞ –∏–∑–±–µ—Ä–∞ –ø–æ–¥—Ö–æ–¥—è—â –¥—Ä–∞–π–≤–µ—Ä?</h3>
    <p><strong>1. –¢–æ–∫:</strong> I<sub>source</sub> –∏ I<sub>sink</sub> —Ç—Ä—è–±–≤–∞ –¥–∞ –º–æ–≥–∞—Ç –¥–∞ –∑–∞—Ä–µ–¥—è—Ç/—Ä–∞–∑—Ä–µ–¥—è—Ç gate –∫–∞–ø–∞—Ü–∏—Ç–µ—Ç–∞ –∑–∞ –∂–µ–ª–∞–Ω–æ—Ç–æ –≤—Ä–µ–º–µ –Ω–∞ –ø—Ä–µ–≤–∫–ª—é—á–≤–∞–Ω–µ.</p>
    <p><strong>2. –ù–∞–ø—Ä–µ–∂–µ–Ω–∏–µ:</strong> V<sub>DD</sub> –¥–∏–∞–ø–∞–∑–æ–Ω—ä—Ç –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –ø–æ–∫—Ä–∏–≤–∞ —Ä–∞–±–æ—Ç–Ω–æ—Ç–æ –Ω–∞–ø—Ä–µ–∂–µ–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∞.</p>
    <p><strong>3. –°–∫–æ—Ä–æ—Å—Ç:</strong> –ó–∞ –≤–∏—Å–æ–∫–æ—á–µ—Å—Ç–æ—Ç–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (GaN, SiC) –∏–∑–±–µ—Ä–µ—Ç–µ –¥—Ä–∞–π–≤–µ—Ä–∏ —Å –Ω–∏—Å–∫–æ t<sub>delay</sub> –∏ –±—ä—Ä–∑–∏ t<sub>rise</sub>/t<sub>fall</sub>.</p>
    <p><strong>4. –ò–∑–æ–ª–∞—Ü–∏—è:</strong> –ó–∞ –≤–∏—Å–æ–∫–æ –Ω–∞–ø—Ä–µ–∂–µ–Ω–∏–µ (>400V) –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ –¥—Ä–∞–π–≤–µ—Ä–∏ —Å galvanic isolation.</p>
    <p><strong>5. –§–æ—Ä–º—É–ª–∞:</strong> I<sub>source_needed</sub> ‚â• (Q<sub>g</sub> √ó V<sub>drive</sub>) / t<sub>rise_desired</sub></p>
  </div>
</section>

<!-- Driver Losses Calculation Section -->
<section id="driverLossesSection" class="results" style="display: none;">
  <h2>üìä –ó–∞–≥—É–±–∏ –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä–∞ –∏ –∫–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç</h2>
  
  <div class="row">
    <label class="input-group">
      <span>V<sub>DD</sub> –¥—Ä–∞–π–≤–µ—Ä (V)</span>
      <span class="tooltip-icon">?</span>
      <div class="tooltip">–ó–∞—Ö—Ä–∞–Ω–≤–∞—â–æ –Ω–∞–ø—Ä–µ–∂–µ–Ω–∏–µ –Ω–∞ gate –¥—Ä–∞–π–≤–µ—Ä–∞. –û–±–∏–∫–Ω–æ–≤–µ–Ω–æ 12V, 15V –∏–ª–∏ 18V –∑–∞ Si/SiC, 5V –∑–∞ GaN.</div>
      <input id="vddDriver" type="number" value="15" step="0.1">
    </label>
    
    <label class="input-group">
      <span>f<sub>sw</sub> —á–µ—Å—Ç–æ—Ç–∞ (kHz)</span>
      <span class="tooltip-icon">?</span>
      <div class="tooltip">–ß–µ—Å—Ç–æ—Ç–∞ –Ω–∞ –ø—Ä–µ–≤–∫–ª—é—á–≤–∞–Ω–µ. –í–ª–∏—è–µ –¥–∏—Ä–µ–∫—Ç–Ω–æ –Ω–∞ –¥–∏–Ω–∞–º–∏—á–Ω–∏—Ç–µ –∑–∞–≥—É–±–∏ –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä–∞.</div>
      <input id="fswDriver" type="number" value="100">
    </label>
  </div>
  
  <div class="button-row">
    <button onclick="calculateCombinedLosses()" class="primary-btn">
      <span data-lang="calculateCombined">–ò–∑—á–∏—Å–ª–∏ –∫–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∏ –∑–∞–≥—É–±–∏</span>
    </button>
  </div>
  
  <div id="combinedResults" style="display: none;">
    <h3>–†–µ–∑—É–ª—Ç–∞—Ç–∏</h3>
    <table>
      <tr><td><strong>–ó–∞–≥—É–±–∏ –¥—Ä–∞–π–≤–µ—Ä (–¥–∏–Ω–∞–º–∏—á–Ω–∏)</strong></td><td id="driverDynamicLosses">‚Äî</td></tr>
      <tr><td><strong>–ó–∞–≥—É–±–∏ –¥—Ä–∞–π–≤–µ—Ä (—Å—Ç–∞—Ç–∏—á–Ω–∏)</strong></td><td id="driverStaticLosses">‚Äî</td></tr>
      <tr><td><strong>–û–±—â–æ –¥—Ä–∞–π–≤–µ—Ä</strong></td><td id="driverTotalLosses">‚Äî</td></tr>
      <tr><td><strong>–ó–∞–≥—É–±–∏ —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä</strong></td><td id="transistorLossesInDriver">‚Äî</td></tr>
      <tr><td><strong>–ö–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∏ –∑–∞–≥—É–±–∏</strong></td><td id="combinedTotalLosses">‚Äî</td></tr>
      <tr><td><strong>–ö–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç</strong></td><td id="combinedEfficiency">‚Äî</td></tr>
    </table>
    
    <canvas id="combinedLossChart"></canvas>
    <button id="copyCombinedChart" class="copy-chart-btn" onclick="copyCombinedChart()">üìã –ö–æ–ø–∏—Ä–∞–π –≥—Ä–∞—Ñ–∏–∫–∞</button>
  </div>
</section>

<!-- Efficiency vs Frequency Chart Section -->
<section id="efficiencyVsFreqSection" class="results" style="display: none;">
  <h2>üìà –ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç —Å–ø—Ä—è–º–æ —á–µ—Å—Ç–æ—Ç–∞ (–î—Ä–∞–π–≤–µ—Ä + –¢—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä)</h2>
  <div class="row">
    <label class="input-group">
      <span>–ú–∏–Ω. —á–µ—Å—Ç–æ—Ç–∞ (kHz)</span>
      <input id="freqMin" type="number" value="10">
    </label>
    <label class="input-group">
      <span>–ú–∞–∫—Å. —á–µ—Å—Ç–æ—Ç–∞ (kHz)</span>
      <input id="freqMax" type="number" value="500">
    </label>
  </div>
  <button onclick="generateEfficiencyVsFrequency()" class="primary-btn">
    <span data-lang="generateChart">–ì–µ–Ω–µ—Ä–∏—Ä–∞–π –≥—Ä–∞—Ñ–∏–∫–∞</span>
  </button>
  <canvas id="efficiencyFreqChart"></canvas>
</section>

<!-- Overlay –∏ modal –∑–∞ –æ–±—è—Å–Ω–µ–Ω–∏—è -->
<div class="overlay" id="overlay"></div>
<div class="term-explanation" id="termExplanation">
  <button class="close-btn" onclick="closeTermExplanation()">√ó</button>
  <h3 id="termTitle"></h3>
  <div id="termContent"></div>
</div>
{% endblock %}
